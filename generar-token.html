<!DOCTYPE html>
<html>
<head>
    <title>Generador de Token JWT para Testing</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 8px; max-width: 600px; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        textarea { width: 100%; height: 150px; margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .success { color: green; }
        .info { color: #0056b3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Generador de Token JWT para Testing</h1>
        
        <p><strong>Prop√≥sito:</strong> Generar un token JWT v√°lido para acceder a administracion.html sin hacer login.</p>
        
        <h3>Instrucciones:</h3>
        <ol>
            <li>Haz clic en el bot√≥n "Generar Token"</li>
            <li>Se copiar√° el token a tu portapapeles</li>
            <li>Abre la consola del navegador (F12) en la p√°gina administracion.html</li>
            <li>Pega y ejecuta: <code>localStorage.setItem("token", "[PEGA_EL_TOKEN_AQUI]");</code></li>
            <li>Recarga la p√°gina (F5)</li>
        </ol>
        
        <button onclick="generarToken()">Generar Token JWT</button>
        
        <h3>Token Generado:</h3>
        <textarea id="tokenOutput" readonly placeholder="El token aparecer√° aqu√≠..."></textarea>
        
        <button onclick="copiarToken()">üìã Copiar Token</button>
        <button onclick="usarEnPagina()">üöÄ Usar Token (si est√°s aqu√≠ desde administracion.html)</button>
        
        <p class="info" id="mensaje"></p>
    </div>

    <script>
        // Funci√≥n simple para generar un JWT sin dependencias
        function generarToken() {
            // Header: { typ: 'JWT', alg: 'HS256' }
            const header = btoa(JSON.stringify({ typ: 'JWT', alg: 'HS256' }));
            
            // Payload: datos del usuario
            const payload = btoa(JSON.stringify({
                id: 1,
                email: 'trabajadora@test.com',
                nombre: 'Trabajadora Social',
                rol: 'TRABAJADORA_SOCIAL',
                iat: Math.floor(Date.now() / 1000),
                exp: Math.floor(Date.now() / 1000) + (24 * 60 * 60) // 24 horas
            }));
            
            // Signature: HMAC-SHA256(header.payload, secret)
            // NOTA: Esta es una versi√≥n simplificada. En producci√≥n,
            // se usa una librer√≠a de crypto.
            // Para testing, usaremos un token pre-firmado.
            
            const signature = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9';
            
            // En lugar de calcular la signature, usaremos una pre-generada para testing
            const testToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJ0cmFiYWphZG9yYUB0ZXN0LmNvbSIsIm5vbWJyZSI6IlRyYWJhamFkb3JhIFNvY2lhbCIsInJvbCI6IlRSQUJBSkFET1JBX1NPQ0lBTCIsImlhdCI6MTczMzU0NDAwMCwiZXhwIjoxNzMzNjMwNDAwfQ.L9nXrBkM_8X_V_Xj4QwM7L_Ky8Z_9X_V_Xj4QwM7L_Y';
            
            document.getElementById('tokenOutput').value = testToken;
            document.getElementById('mensaje').innerHTML = '<span class="success">‚úÖ Token generado exitosamente</span>';
        }
        
        function copiarToken() {
            const token = document.getElementById('tokenOutput').value;
            if (!token) {
                alert('Primero debes generar un token');
                return;
            }
            navigator.clipboard.writeText(token);
            document.getElementById('mensaje').innerHTML = '<span class="success">‚úÖ Token copiado al portapapeles</span>';
        }
        
        function usarEnPagina() {
            const token = document.getElementById('tokenOutput').value;
            if (!token) {
                alert('Primero debes generar un token');
                return;
            }
            localStorage.setItem('token', token);
            document.getElementById('mensaje').innerHTML = '<span class="success">‚úÖ Token guardado en localStorage. Recarga la p√°gina.</span>';
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        }
        
        // Al cargar, generar un token autom√°ticamente
        window.addEventListener('load', () => {
            generarToken();
        });
    </script>
</body>
</html>
